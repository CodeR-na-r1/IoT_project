# Итоговый проект по курсу IoT

## Как запустить проект

### > Server python FastApi

Запускается первым, командой uvicorn server:app --host 192.168.0.10 --ws-ping-interval 500

Используется опция *--ws-ping-interval* для отсрочки проверки ping/pong. Так как библитека WebSoskets у esp8266 не поддерживает обработку пакетов такого типа. В случае отключения, esp попробует подключиться заного и, в случае неудачи, перезагрузится.

### > Esp beacon

Установаить поддержку для esp8266 в Arduino IDE, добавить нужные библиотеки (инструкция ниже) и загрузить прошивку на МК.

### > Android client

Склонировать репозиторий, открыть в Android studio, загрузить на телефон и запустить.

## Модули, библиотеки (список, способ установки)

### > Server python FastApi

+ FastAPI: Фреймворк для создания API сервера на python 3.10+
Способ установки: pip install fastapi

+ Uvicorn: нужен для запуска и работы сервера
Способ установки: pip install "uvicorn[standard]"

### > Esp beacon

+ EEPROM: Работа с энергонезависимой памятью (by default)
+ Wi-Fi: Работа с подключением к сетям Wi-Fi, а также создание собственной точки доступа Wi-Fi (by default)
+ WebSockets: Подключение и обмен данными с веб-сервером при помощи технологии WebSockets (https://github.com/morrissinger/ESP8266-Websocket)
+ FastLED: Удобная работа с адресной светодиодной лентой (FastLED by Daniel Garcia)
+ ArduinoJson: Работа с десериализацией данных формата JSON (ArduinoJson by Benoit Blanchon)
+ Ticker: Работа с прерываниями по таймеру (by default)
+ ESPAsyncWebSrv: Запуск веб-сервера на микроконтроллере (ESPAsyncWebSrv by dvarrel) (https://github.com/dvarrel/ESPAsyncWebSrv)

Библиотеки либо уже установлены в Arduino IDE, либо устанавливаются через менеджер библиотек

### > Android client

+ Retrofit: Библиотека для упрощённого и эффективного сетевого взаимодействия
+ Gson: Библиотека для работы с сериализацией и десериализацией данных формата JSON
+ WebSockets: Библиотека для подключения и обмена данными с веб-сервером при помощи технологии WebSockets
+ IndoorService: Библиотека для работы с внутренним позиционированием (обнаружение esp по wi-fi, а также замера rssi)

Зависимости устанавливаются gradle автоматически. Кроме IndoorService: для нее инструкция здесь: https://github.com/CodeR-na-r1/IndoorService

## Схемы работы программных частей:

### > Server python FastApi

КАРТИНКА

### > Android client

КАРТИНКА

### > Esp beacon

КАРТИНКА

## Основные компоненты:

1. Плата мк esp8266
2. Адресная светодиодная лента, плотность не менее 60 светодиодов на метр, длина зависит от размера корпуса
3. Аккумулятор 18350 *2
4. Модуль для зарядки аккумулятора
    + Type с модуль без обвязки
    + Регулируемый понижающий регулятор напряжения
    + Плата BMS 2S 20A 8,4В

5. Кнопка управления питанием (вкл/выкл)

*Печатные компоненты:*

1. Корпус для всех компонент
1. Корпус для аккумуляторов